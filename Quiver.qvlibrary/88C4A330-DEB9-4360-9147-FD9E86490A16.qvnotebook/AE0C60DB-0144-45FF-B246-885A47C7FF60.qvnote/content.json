{
  "title": "层次命名空间",
  "cells": [
    {
      "type": "text",
      "data": "<p trans_replace=\"0\" trans=\"1\" style=\"margin: 0px 0px 5px; padding: 0px; word-wrap: break-word; color: rgb(0, 0, 0); line-height: 1.7; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><span style=\"margin: 0px; padding: 0px;\">下图描述了用于内存表示的ZooKeeper文件系统的树结构。</span><span style=\"margin: 0px; padding: 0px;\">ZooKeeper节点称为<strong style=\"margin: 0px; padding: 0px;\">&nbsp;znode&nbsp;</strong>。</span><span style=\"margin: 0px; padding: 0px;\">每个znode由一个名称标识，并用路径(/)序列分隔。</span></p><ul class=\"list\" style=\"margin: 10px 0px; padding: 0px 0px 0px 30px; list-style-position: outside; list-style-image: none; line-height: 1.7; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><li style=\"margin: 0px; padding: 0px;\"><p trans_replace=\"0\" trans=\"1\" style=\"margin: 0px 0px 5px; padding: 0px; word-wrap: break-word; color: rgb(0, 0, 0); line-height: 1.7;\"><span style=\"margin: 0px; padding: 0px;\">在图中，首先有一个由“/”分隔的znode。</span><span style=\"margin: 0px; padding: 0px;\">在根目录下，你有两个逻辑命名空间<strong style=\"margin: 0px; padding: 0px;\">&nbsp;config&nbsp;</strong>和<strong style=\"margin: 0px; padding: 0px;\">&nbsp;workers&nbsp;</strong>。</span></p></li><li style=\"margin: 0px; padding: 0px;\"><p trans_replace=\"0\" trans=\"1\" style=\"margin: 0px 0px 5px; padding: 0px; word-wrap: break-word; color: rgb(0, 0, 0); line-height: 1.7;\"><span style=\"margin: 0px; padding: 0px;\"><strong style=\"margin: 0px; padding: 0px;\">config&nbsp;</strong>命名空间用于集中式配置管理，<strong style=\"margin: 0px; padding: 0px;\">workers&nbsp;</strong>命名空间用于命名。</span></p></li><li style=\"margin: 0px; padding: 0px;\"><p trans_replace=\"0\" trans=\"1\" style=\"margin: 0px 0px 5px; padding: 0px; word-wrap: break-word; color: rgb(0, 0, 0); line-height: 1.7;\"><span style=\"margin: 0px; padding: 0px;\">在<strong style=\"margin: 0px; padding: 0px;\">&nbsp;config&nbsp;</strong>命名空间下，每个znode最多可存储1MB的数据。</span><span style=\"margin: 0px; padding: 0px;\">这与UNIX文件系统相类似，除了父znode也可以存储数据。</span><span style=\"margin: 0px; padding: 0px;\">这种结构的主要目的是存储同步数据并描述znode的元数据。</span><span style=\"margin: 0px; padding: 0px;\">此结构称为<strong style=\"margin: 0px; padding: 0px;\">&nbsp;ZooKeeper数据模型</strong>。</span></p></li></ul>"
    },
    {
      "type": "text",
      "data": "<img src=\"quiver-image-url/4D15A2184EE3010C71029578155851FF.png\" alt=\"2017-11-08 at 6.25 AM.png\" width=\"766\" height=\"513\">"
    },
    {
      "type": "text",
      "data": "<p trans_replace=\"0\" trans=\"1\" style=\"margin: 0px 0px 5px; padding: 0px; word-wrap: break-word; color: rgb(0, 0, 0); line-height: 1.7; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\">ZooKeeper数据模型中的每个znode都维护着一个<strong style=\"margin: 0px; padding: 0px;\">&nbsp;stat&nbsp;</strong>结构。一个stat仅提供一个znode的<strong style=\"margin: 0px; padding: 0px;\">元数据</strong>。它由版本号，操作控制列表(ACL)，时间戳和数据长度组成。</p><ul class=\"list\" style=\"margin: 10px 0px; padding: 0px 0px 0px 30px; list-style-position: outside; list-style-image: none; line-height: 1.7; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><li style=\"margin: 0px; padding: 0px;\"><p trans_replace=\"0\" trans=\"1\" style=\"margin: 0px 0px 5px; padding: 0px; word-wrap: break-word; color: rgb(0, 0, 0); line-height: 1.7;\"><span style=\"margin: 0px; padding: 0px;\"><strong style=\"margin: 0px; padding: 0px;\">版本号</strong>&nbsp;- 每个znode都有版本号，这意味着每当与znode相关联的数据发生变化时，其对应的版本号也会增加。</span><span style=\"margin: 0px; padding: 0px;\">当多个zookeeper客户端尝试在同一znode上执行操作时，版本号的使用就很重要。</span></p></li><li style=\"margin: 0px; padding: 0px;\"><p trans_replace=\"0\" trans=\"1\" style=\"margin: 0px 0px 5px; padding: 0px; word-wrap: break-word; color: rgb(0, 0, 0); line-height: 1.7;\"><span style=\"margin: 0px; padding: 0px;\"><strong style=\"margin: 0px; padding: 0px;\">操作控制列表(ACL)</strong>&nbsp;- ACL基本上是访问znode的认证机制。</span><span style=\"margin: 0px; padding: 0px;\">它管理所有znode读取和写入操作。</span></p></li><li style=\"margin: 0px; padding: 0px;\"><p trans_replace=\"0\" trans=\"1\" style=\"margin: 0px 0px 5px; padding: 0px; word-wrap: break-word; color: rgb(0, 0, 0); line-height: 1.7;\"><span style=\"margin: 0px; padding: 0px;\"><strong style=\"margin: 0px; padding: 0px;\">时间戳</strong>&nbsp;- 时间戳表示创建和修改znode所经过的时间。</span><span style=\"margin: 0px; padding: 0px;\">它通常以毫秒为单位。</span><span style=\"margin: 0px; padding: 0px;\">ZooKeeper从“事务ID\"(zxid)标识znode的每个更改。</span><span style=\"margin: 0px; padding: 0px;\"><strong style=\"margin: 0px; padding: 0px;\">Zxid&nbsp;</strong>是唯一的，并且为每个事务保留时间，以便你可以轻松地确定从一个请求到另一个请求所经过的时间。</span></p></li><li style=\"margin: 0px; padding: 0px;\"><p trans_replace=\"0\" trans=\"1\" style=\"margin: 0px 0px 5px; padding: 0px; word-wrap: break-word; color: rgb(0, 0, 0); line-height: 1.7;\"><span style=\"margin: 0px; padding: 0px;\"><strong style=\"margin: 0px; padding: 0px;\">数据长度</strong>&nbsp;- 存储在znode中的数据总量是数据长度。</span><span style=\"margin: 0px; padding: 0px;\">你最多可以存储1MB的数据。</span></p></li></ul>"
    },
    {
      "type": "text",
      "data": "<h3 trans_replace=\"0\" trans=\"1\" style=\"margin: 20px 0px 10px; padding: 0px; color: rgb(0, 0, 0); line-height: 1.7; font-size: 14px; font-family: Verdana, Arial, Helvetica, sans-serif; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><span style=\"margin: 0px; padding: 0px;\">Znode的类型</span></h3><p trans_replace=\"0\" trans=\"1\" style=\"margin: 0px 0px 5px; padding: 0px; word-wrap: break-word; color: rgb(0, 0, 0); line-height: 1.7; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><span style=\"margin: 0px; padding: 0px;\">Znode被分为持久（persistent）节点，顺序（sequential）节点和临时（ephemeral）节点。</span></p><ul class=\"list\" style=\"margin: 10px 0px; padding: 0px 0px 0px 30px; list-style-position: outside; list-style-image: none; line-height: 1.7; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255);\"><li style=\"margin: 0px; padding: 0px;\"><p trans_replace=\"0\" trans=\"1\" style=\"margin: 0px 0px 5px; padding: 0px; word-wrap: break-word; color: rgb(0, 0, 0); line-height: 1.7;\"><span style=\"margin: 0px; padding: 0px;\"><strong style=\"margin: 0px; padding: 0px;\">持久节点&nbsp;</strong>&nbsp;- 即使在创建该特定znode的客户端断开连接后，持久节点仍然存在。</span><span style=\"margin: 0px; padding: 0px;\">默认情况下，除非另有说明，否则所有znode都是持久的。</span></p></li><li style=\"margin: 0px; padding: 0px;\"><p trans_replace=\"0\" trans=\"1\" style=\"margin: 0px 0px 5px; padding: 0px; word-wrap: break-word; color: rgb(0, 0, 0); line-height: 1.7;\"><span style=\"margin: 0px; padding: 0px;\"><strong style=\"margin: 0px; padding: 0px;\">临时节点&nbsp;</strong>- 客户端活跃时，临时节点就是有效的。</span><span style=\"margin: 0px; padding: 0px;\">当客户端与ZooKeeper集合断开连接时，临时节点会自动删除。</span><span style=\"margin: 0px; padding: 0px;\">因此，只有临时节点不允许有子节点。</span><span style=\"margin: 0px; padding: 0px;\">如果临时节点被删除，则下一个合适的节点将填充其位置。临时节点</span><span style=\"margin: 0px; padding: 0px;\">在leader选举中起着重要作用。</span></p></li><li style=\"margin: 0px; padding: 0px;\"><p trans_replace=\"0\" trans=\"1\" style=\"margin: 0px 0px 5px; padding: 0px; word-wrap: break-word; color: rgb(0, 0, 0); line-height: 1.7;\"><span style=\"margin: 0px; padding: 0px;\"><strong style=\"margin: 0px; padding: 0px;\">顺序节点&nbsp;</strong>- 顺序节点可以是持久的或临时的。</span><span style=\"margin: 0px; padding: 0px;\">当一个新的znode被创建为一个顺序节点时，ZooKeeper通过将10位的序列号附加到原始名称来设置znode的路径。</span><span style=\"margin: 0px; padding: 0px;\">例如，如果将具有路径<strong style=\"margin: 0px; padding: 0px;\">&nbsp;/myapp&nbsp;</strong>的znode创建为顺序节点，则ZooKeeper会将路径更改为<strong style=\"margin: 0px; padding: 0px;\">&nbsp;/myapp0000000001&nbsp;</strong>，并将下一个序列号设置为0000000002。如果两个顺序节点是同时创建的</span><span style=\"margin: 0px; padding: 0px;\">，那么ZooKeeper不会对每个znode使用相同的数字。</span><span style=\"margin: 0px; padding: 0px;\">顺序节点在锁定和同步中起重要作用。</span></p></li></ul>"
    }
  ]
}